<html>
<head>
<title>SentinelAI Desktop</title>
<HTA:APPLICATION
    ID="SentinelAI"
    APPLICATIONNAME="SentinelAI Desktop"
    BORDER="thin"
    BORDERSTYLE="normal"
    CAPTION="yes"
    ICON="sentinel.ico"
    MAXIMIZEBUTTON="yes"
    MINIMIZEBUTTON="yes"
    SHOWINTASKBAR="yes"
    SINGLEINSTANCE="yes"
    SYSMENU="yes"
    VERSION="1.0"
    WINDOWSTATE="normal"
/>
<style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
        font-family: 'Segoe UI', Tahoma, sans-serif;
        background: #1a1a2e;
        color: #eaeaea;
        min-height: 100vh;
        padding: 20px;
    }
    .header {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid #0f3460;
    }
    .logo { font-size: 32px; color: #e94560; }
    h1 { font-size: 24px; font-weight: 600; }
    .subtitle { font-size: 12px; opacity: 0.7; }
    .status-grid {
        display: flex;
        gap: 15px;
        margin-bottom: 20px;
    }
    .status-card {
        flex: 1;
        background: #16213e;
        border-radius: 12px;
        padding: 15px;
        border: 1px solid #0f3460;
    }
    .status-card .value { font-size: 28px; font-weight: 700; }
    .status-card .label { font-size: 12px; opacity: 0.7; }
    .protection-box {
        background: #16213e;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 20px;
        border: 1px solid #0f3460;
    }
    .protection-header {
        display: flex;
        align-items: center;
        gap: 15px;
    }
    .protection-icon {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: rgba(0, 210, 106, 0.2);
        color: #00d26a;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
    }
    .protection-title { font-size: 18px; font-weight: 600; }
    .protection-subtitle { font-size: 12px; opacity: 0.7; }
    .btn {
        background: #e94560;
        border: none;
        color: white;
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 500;
        margin-right: 10px;
        margin-top: 15px;
    }
    .btn:hover { filter: brightness(1.1); }
    .btn-secondary { background: #0f3460; }
    .monitors {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 15px;
    }
    .monitor-item {
        background: #0f3460;
        padding: 8px 15px;
        border-radius: 8px;
        font-size: 12px;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    .dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: #00d26a;
    }
    .log-box {
        background: #16213e;
        border-radius: 12px;
        padding: 15px;
        border: 1px solid #0f3460;
        max-height: 200px;
        overflow-y: auto;
    }
    .log-title { font-size: 14px; font-weight: 600; margin-bottom: 10px; }
    .log-entry {
        font-family: 'Consolas', monospace;
        font-size: 11px;
        padding: 5px 0;
        border-bottom: 1px solid #0f3460;
    }
    .log-time { color: #888; }
    .log-info { color: #00d26a; }
    .log-warn { color: #ffc107; }
    .log-error { color: #e94560; }
</style>
<script language="VBScript">
Sub OpenDashboard
    Dim shell
    Set shell = CreateObject("WScript.Shell")
    shell.Run "http://localhost:8015"
End Sub

Sub StartAgent
    Dim shell, fso, agentPath
    Set shell = CreateObject("WScript.Shell")
    Set fso = CreateObject("Scripting.FileSystemObject")
    agentPath = fso.GetParentFolderName(document.location.pathname) & "\..\windows_agent\run_agent.bat"
    If fso.FileExists(agentPath) Then
        shell.Run "cmd /c """ & agentPath & """", 1, False
        AddLog "INFO", "Agent started"
    Else
        AddLog "ERROR", "Agent not found at: " & agentPath
    End If
End Sub

Sub RefreshStatus
    AddLog "INFO", "Refreshing status..."
End Sub

Sub AddLog(level, msg)
    Dim logBox, entry, timeStr
    Set logBox = document.getElementById("logBox")
    timeStr = FormatDateTime(Now, 4)
    entry = "<div class='log-entry'><span class='log-time'>" & timeStr & "</span> "
    entry = entry & "<span class='log-" & LCase(level) & "'>[" & level & "]</span> " & msg & "</div>"
    logBox.innerHTML = entry & logBox.innerHTML
End Sub

Sub Window_OnLoad
    AddLog "INFO", "SentinelAI Desktop started"
    AddLog "INFO", "Dashboard: http://localhost:8015"
End Sub
</script>
</head>
<body>
    <div class="header">
        <div class="logo">üõ°Ô∏è</div>
        <div>
            <h1>SentinelAI Desktop</h1>
            <div class="subtitle">Native Security Agent v1.2</div>
        </div>
    </div>
    
    <div class="status-grid">
        <div class="status-card">
            <div class="value" style="color: #00d26a;">0</div>
            <div class="label">Threats Blocked</div>
        </div>
        <div class="status-card">
            <div class="value" style="color: #e94560;">0</div>
            <div class="label">Active Threats</div>
        </div>
        <div class="status-card">
            <div class="value">11</div>
            <div class="label">Active Monitors</div>
        </div>
    </div>
    
    <div class="protection-box">
        <div class="protection-header">
            <div class="protection-icon">‚úì</div>
            <div>
                <div class="protection-title">Protected</div>
                <div class="protection-subtitle">All security monitors are active</div>
            </div>
        </div>
        <div class="monitors">
            <div class="monitor-item"><div class="dot"></div>Process</div>
            <div class="monitor-item"><div class="dot"></div>Network</div>
            <div class="monitor-item"><div class="dot"></div>EventLog</div>
            <div class="monitor-item"><div class="dot"></div>Registry</div>
            <div class="monitor-item"><div class="dot"></div>Startup</div>
            <div class="monitor-item"><div class="dot"></div>Tasks</div>
            <div class="monitor-item"><div class="dot"></div>USB</div>
            <div class="monitor-item"><div class="dot"></div>Hosts</div>
            <div class="monitor-item"><div class="dot"></div>Browser</div>
            <div class="monitor-item"><div class="dot"></div>Firewall</div>
            <div class="monitor-item"><div class="dot"></div>AI</div>
        </div>
        <div>
            <button class="btn" onclick="OpenDashboard">Open Dashboard</button>
            <button class="btn btn-secondary" onclick="StartAgent">Start Agent</button>
            <button class="btn btn-secondary" onclick="RefreshStatus">Refresh</button>
        </div>
    </div>
    
    <div class="log-box">
        <div class="log-title">Activity Log</div>
        <div id="logBox"></div>
    </div>
</body>
</html>
